!function(){function t(t,i){this._tstage=t,this._tlayer=i,this._sw=t.getWidth(),this._sh=t.getHeight(),this._redectTime=0,this._refireTime=50,this._bulletArr=[],this._destroyed=!1}function i(t,i){this._tstage=t,this._tlayer=i,this._sw=t.getWidth(),this._sh=t.getHeight(),this._tankW=60,this._tankH=80,this._moveV=0,this._curDirect=0,this._backColor="aqua",this._moveAble=!1,this._bulletArr=[],this._tankType=3,this._destroyed=!1}t.prototype={selectType:function(){switch(this._tankType=Math.floor(3*Math.random()),this._tankType){case 0:this._tankW=60,this._tankH=90,this._moveV=4,this._curDirect=2,this._backColor="green",this._directTime=50,this._fireTime=70;break;case 1:this._tankW=55,this._tankH=100,this._moveV=7,this._curDirect=2,this._backColor="red",this._directTime=40,this._fireTime=80;break;case 2:this._tankW=70,this._tankH=100,this._moveV=3,this._curDirect=2,this._backColor="blue",this._directTime=60,this._fireTime=70}},createTank:function(t,i){var e=this;e._tank=new Konva.Image({width:e._tankW,height:e._tankH,offset:{x:e._tankW/2,y:e._tankH/2},x:t.x,y:t.y,rotation:180,name:"foeTank",destroyed:!1,image:i}),e._tlayer.add(e._tank),e._tlayer.batchDraw()},tankMove:function(){if(this._tank.getAttr("destroyed")){if(this._destroyed=!0,this._bulletArr&&this._bulletArr.length>0){for(var t=this,i=0;i<t._bulletArr.length;i++)!function(i){t._bulletArr[i]._curBullet.destroy()}(i);t._bulletArr=[]}}else{if(this._redectTime<=0?(this.directChange(),this.timeToRedirect()):this._redectTime--,this._refireTime<=0?(this.fierBullet(),this.timeToRefire()):this._refireTime--,this._bulletArr&&this._bulletArr.length>0)for(var t=this,i=0;i<this._bulletArr.length;i++)!function(i){var e=t._bulletArr[i];if(e._destroyed)return void t._bulletArr.splice(i,1);e.bulletMove()}(i);switch(this._curDirect){case 0:this._tank.y(this._tank.y()-this._moveV);break;case 1:this._tank.x(this._tank.x()+this._moveV);break;case 2:this._tank.y(this._tank.y()+this._moveV);break;case 3:this._tank.x(this._tank.x()-this._moveV)}this.boundJudge()}},boundJudge:function(){var t=this._tank.x(),i=this._tank.y();switch(this._curDirect){case 0:if(!(i-this._tankH/2<0))return;this._tank.y(this._tankW/2),this.directChange(),this.timeToRedirect();break;case 1:var e=t+this._tankH/2;if(!(e>this._sw))return;console.log(e),this._tank.x(this._sw-this._tankW/2),this.directChange(),this.timeToRedirect();case 2:if(!(i+this._tankH/2>this._sh))return;this._tank.y(this._sh-this._tankW/2),this.directChange(),this.timeToRedirect();case 3:if(!(t-this._tankH/2<0))return;this._tank.x(this._tankW/2),this.directChange(),this.timeToRedirect()}},directChange:function(){var t;do{t=Math.floor(4*Math.random())}while(t==this._curDirect);var i=90*t;this._curDirect=t,this._tank.rotation(i)},fierBullet:function(){var t=new window.Bullet(this._tstage,this._tlayer),i={};switch(this._curDirect){case 0:i.x=this._tank.x(),i.y=this._tank.y()-this._tankH/2;break;case 1:i.x=this._tank.x()+this._tankH/2,i.y=this._tank.y();break;case 2:i.x=this._tank.x(),i.y=this._tank.y()+this._tankH/2;break;case 3:i.x=this._tank.x()-this._tankH/2,i.y=this._tank.y()}t.selectType(this._tankType),t.createBullet(this._curDirect,i),this._bulletArr.push(t)},timeToRedirect:function(){this._redectTime=Math.floor(Math.random()*this._directTime)+20},timeToRefire:function(){this._refireTime=Math.floor(Math.random()*this._fireTime)+50}},i.prototype={createTank:function(t,i){var e=this;e._tank=new Konva.Image({width:e._tankW,height:e._tankH,offset:{x:e._tankW/2,y:e._tankH/2},x:t.x,y:t.y,rotation:0,name:"myTank",destroyed:!1,image:i}),e._tlayer.add(e._tank),e._tlayer.batchDraw()},tankMove:function(){if(this._tank.getAttr("destroyed"))return void(this._destroyed=!0);if(this._redectTime<=0?(this.directChange(),this.timeToRedirect()):this._redectTime--,this._bulletArr&&this._bulletArr.length>0)for(var t=this,i=0;i<this._bulletArr.length;i++)!function(i){var e=t._bulletArr[i];if(e._destroyed)return void t._bulletArr.splice(i,1);e.bulletMove()}(i);switch(this._curDirect){case 0:this._tank.y(this._tank.y()-this._moveV);break;case 1:this._tank.x(this._tank.x()+this._moveV);break;case 2:this._tank.y(this._tank.y()+this._moveV);break;case 3:this._tank.x(this._tank.x()-this._moveV)}this.boundJudge()},boundJudge:function(){var t=this._tank.x(),i=this._tank.y();switch(this._curDirect){case 0:if(!(i-this._tankH/2<0))return;this._tank.y(this._tankW/2);break;case 1:if(!(t+this._tankH/2>this._sw))return;this._tank.x(this._sw-this._tankW/2);case 2:if(!(i+this._tankH/2>this._sh))return;this._tank.y(this._sh-this._tankW/2);case 3:if(!(t-this._tankH/2<0))return;this._tank.x(this._tankW/2)}},directChange:function(t){this._curDirect=t;var i=90*this._curDirect;this._tank.rotation(i)},fireBullet:function(){var t=new window.Bullet(this._tstage,this._tlayer),i={};switch(this._curDirect){case 0:i.x=this._tank.x(),i.y=this._tank.y()-this._tankH/2;break;case 1:i.x=this._tank.x()+this._tankH/2,i.y=this._tank.y();break;case 2:i.x=this._tank.x(),i.y=this._tank.y()+this._tankH/2;break;case 3:i.x=this._tank.x()-this._tankH/2,i.y=this._tank.y()}t.selectType(this._tankType),t.createBullet(this._curDirect,i),this._bulletArr.push(t)}},window.FoeTank=t,window.MyTank=i}();
//# sourceMappingURL=tank.min.js.map
