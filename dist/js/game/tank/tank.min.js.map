{"version":3,"sources":["js/game/tank/tank.js"],"names":["FoeTank","stage","layer","this","_tstage","_tlayer","_sw","getWidth","_sh","getHeight","_redectTime","_refireTime","_bulletArr","_destroyed","MyTank","_tankW","_tankH","_moveV","_curDirect","_backColor","_moveAble","_tankType","prototype","selectType","Math","floor","random","_directTime","_fireTime","createTank","pos","image","that","_tank","Konva","Image","width","height","offset","x","y","rotation","name","destroyed","add","batchDraw","tankMove","getAttr","length","i","_curBullet","destroy","directChange","timeToRedirect","fierBullet","timeToRefire","bullet","splice","bulletMove","boundJudge","cx","cy","cr","console","log","curDirect","window","Bullet","createBullet","push","direct","fireBullet"],"mappings":"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","file":"tank.min.js","sourcesContent":["(function () {\r\n    function FoeTank(stage, layer) {\r\n        this._tstage = stage;\r\n        this._tlayer = layer;\r\n        this._sw = stage.getWidth();\r\n        this._sh = stage.getHeight();\r\n        this._redectTime = 0;\r\n        this._refireTime = 50;\r\n        this._bulletArr = [];\r\n        this._destroyed = false;\r\n    };\r\n    FoeTank.prototype = {\r\n        selectType: function () {\r\n            this._tankType = Math.floor(Math.random() * 3);\r\n            switch (this._tankType) {\r\n                case 0:\r\n                    this._tankW = 60;\r\n                    this._tankH = 90;\r\n                    this._moveV = 4;\r\n                    this._curDirect = 2;\r\n                    this._backColor = 'green';\r\n                    this._directTime = 50;\r\n                    this._fireTime = 70;\r\n                    break;\r\n                case 1:\r\n                    this._tankW = 55;\r\n                    this._tankH = 100;\r\n                    this._moveV = 7;\r\n                    this._curDirect = 2;\r\n                    this._backColor = 'red';\r\n                    this._directTime = 40;\r\n                    this._fireTime = 80;\r\n                    break;\r\n                case 2:\r\n                    this._tankW = 70;\r\n                    this._tankH = 100;\r\n                    this._moveV = 3;\r\n                    this._curDirect = 2;\r\n                    this._backColor = 'blue';\r\n                    this._directTime = 60;\r\n                    this._fireTime = 70;\r\n                    break;\r\n            }\r\n        },\r\n        createTank: function (pos,image) {\r\n            var that = this;\r\n            that._tank = new Konva.Image({\r\n                width: that._tankW,\r\n                height: that._tankH,\r\n                offset: {\r\n                    x: that._tankW / 2,\r\n                    y: that._tankH / 2,\r\n                },\r\n                x: pos.x,\r\n                y: pos.y,\r\n                rotation: 180,\r\n                name: 'foeTank',\r\n                destroyed: false,\r\n                image:image\r\n            });\r\n            that._tlayer.add(that._tank);\r\n            that._tlayer.batchDraw();\r\n        },\r\n        tankMove: function () {\r\n            if (this._tank.getAttr('destroyed')) {\r\n                this._destroyed = true;\r\n                if (this._bulletArr && this._bulletArr.length > 0) {\r\n                    var that = this;\r\n                    for (var i = 0; i < that._bulletArr.length; i++) {\r\n                        (function (i) {\r\n                            that._bulletArr[i]._curBullet.destroy();\r\n                        })(i);\r\n                    }\r\n                    that._bulletArr = [];\r\n                }\r\n                return;\r\n            }\r\n            if (this._redectTime <= 0) {\r\n                this.directChange();\r\n                this.timeToRedirect();\r\n            } else {\r\n                this._redectTime--;\r\n            }\r\n            if (this._refireTime <= 0) {\r\n                this.fierBullet();\r\n                this.timeToRefire();\r\n            } else {\r\n                this._refireTime--;\r\n            }\r\n            if (this._bulletArr && this._bulletArr.length > 0) {\r\n                var that = this;\r\n                for (var i = 0; i < this._bulletArr.length; i++) {\r\n                    (function (i) {\r\n                        var bullet = that._bulletArr[i];\r\n                        if (bullet._destroyed) {\r\n                            that._bulletArr.splice(i, 1);\r\n                            return;\r\n                        }\r\n                        bullet.bulletMove();\r\n                    })(i);\r\n                }\r\n            }\r\n            switch (this._curDirect) {\r\n                case 0:\r\n                    this._tank.y(this._tank.y() - this._moveV);\r\n                    break;\r\n                case 1:\r\n                    this._tank.x(this._tank.x() + this._moveV);\r\n                    break;\r\n                case 2:\r\n                    this._tank.y(this._tank.y() + this._moveV);\r\n                    break;\r\n                case 3:\r\n                    this._tank.x(this._tank.x() - this._moveV);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            this.boundJudge();\r\n            // this._tlayer.batchDraw();\r\n        },\r\n        boundJudge: function () {\r\n            var cx = this._tank.x();\r\n            var cy = this._tank.y();\r\n\r\n            switch (this._curDirect) {\r\n                case 0:\r\n                    var ct = cy - this._tankH / 2;\r\n                    if (ct < 0) {\r\n                        this._tank.y(this._tankW / 2);\r\n                        this.directChange();\r\n                        this.timeToRedirect();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                    break;\r\n                case 1:\r\n                    var cr = cx + this._tankH / 2;\r\n                    if (cr > this._sw) {\r\n                        console.log(cr);\r\n                        this._tank.x(this._sw - this._tankW / 2);\r\n                        this.directChange();\r\n                        this.timeToRedirect();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                case 2:\r\n                    var cb = cy + this._tankH / 2;\r\n                    if (cb > this._sh) {\r\n                        this._tank.y(this._sh - this._tankW / 2);\r\n                        this.directChange();\r\n                        this.timeToRedirect();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                case 3:\r\n                    var cl = cx - this._tankH / 2;\r\n                    if (cl < 0) {\r\n                        this._tank.x(this._tankW / 2);\r\n                        this.directChange();\r\n                        this.timeToRedirect();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n        directChange: function () {\r\n            var curDirect;\r\n            do {\r\n                curDirect = Math.floor(Math.random() * 4);\r\n            } while (curDirect == this._curDirect);\r\n            var rotation = curDirect * 90;\r\n            this._curDirect = curDirect;\r\n            this._tank.rotation(rotation);\r\n        },\r\n        fierBullet: function () {\r\n            var bullet = new window.Bullet(this._tstage, this._tlayer);\r\n            var pos = {};\r\n            switch (this._curDirect) {\r\n                case 0:\r\n                    pos.x = this._tank.x();\r\n                    pos.y = this._tank.y() - this._tankH / 2;\r\n                    break;\r\n                case 1:\r\n                    pos.x = this._tank.x() + this._tankH / 2;\r\n                    pos.y = this._tank.y();\r\n                    break;\r\n                case 2:\r\n                    pos.x = this._tank.x();\r\n                    pos.y = this._tank.y() + this._tankH / 2;\r\n                    break;\r\n                case 3:\r\n                    pos.x = this._tank.x() - this._tankH / 2;\r\n                    pos.y = this._tank.y();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            bullet.selectType(this._tankType);\r\n            bullet.createBullet(this._curDirect, pos);\r\n            this._bulletArr.push(bullet);\r\n        },\r\n        timeToRedirect: function () {\r\n            this._redectTime = Math.floor(Math.random() * this._directTime) + 20;\r\n        },\r\n        timeToRefire: function () {\r\n            this._refireTime = Math.floor(Math.random() * this._fireTime) + 50;\r\n        }\r\n    };\r\n\r\n    // ======================== tank range =========================//\r\n\r\n    function MyTank(stage, layer) {\r\n        this._tstage = stage;\r\n        this._tlayer = layer;\r\n        this._sw = stage.getWidth();\r\n        this._sh = stage.getHeight();\r\n        this._tankW = 60;\r\n        this._tankH = 80;\r\n        this._moveV = 0;\r\n        this._curDirect = 0;\r\n        this._backColor = 'aqua';\r\n        this._moveAble = false;\r\n        this._bulletArr = [];\r\n        this._tankType = 3;\r\n        this._destroyed = false;\r\n    };\r\n    MyTank.prototype = {\r\n        createTank: function (pos,image) {\r\n            var that = this;\r\n            that._tank = new Konva.Image({\r\n                width: that._tankW,\r\n                height: that._tankH,\r\n                offset: {\r\n                    x: that._tankW / 2,\r\n                    y: that._tankH / 2,\r\n                },\r\n                x: pos.x,\r\n                y: pos.y,\r\n                rotation: 0,\r\n                name: 'myTank',\r\n                destroyed: false,\r\n                image:image\r\n            });\r\n            // var back = new Konva.Rect({\r\n            //     width: that._tankW,\r\n            //     height: that._tankH,\r\n            //     x: 0,\r\n            //     y: 0,\r\n            //     fill: that._backColor\r\n            // });\r\n            // var wedge = new Konva.Wedge({\r\n            //     x: that._tankW / 2,\r\n            //     y: that._tankH / 2,\r\n            //     radius: 30,\r\n            //     angle: -300,\r\n            //     fill: 'yellow',\r\n            //     stroke: 'black',\r\n            //     strokeWidth: 2,\r\n            //     rotation: 60\r\n            // });\r\n            // that._tank.add(back);\r\n            // that._tank.add(wedge);\r\n            that._tlayer.add(that._tank);\r\n            that._tlayer.batchDraw();\r\n        },\r\n        tankMove: function () {\r\n            if (this._tank.getAttr('destroyed')) {\r\n                this._destroyed = true;\r\n                return;\r\n            }\r\n            if (this._redectTime <= 0) {\r\n                this.directChange();\r\n                this.timeToRedirect();\r\n            } else {\r\n                this._redectTime--;\r\n            }\r\n            if (this._bulletArr && this._bulletArr.length > 0) {\r\n                var that = this;\r\n                for (var i = 0; i < this._bulletArr.length; i++) {\r\n                    (function (i) {\r\n                        var bullet = that._bulletArr[i];\r\n                        if (bullet._destroyed) {\r\n                            that._bulletArr.splice(i, 1);\r\n                            return;\r\n                        }\r\n                        bullet.bulletMove();\r\n                    })(i);\r\n                }\r\n            }\r\n            // if (this._moveAble) {\r\n\r\n                switch (this._curDirect) {\r\n                    case 0:\r\n                        this._tank.y(this._tank.y() - this._moveV);\r\n                        break;\r\n                    case 1:\r\n                        this._tank.x(this._tank.x() + this._moveV);\r\n                        break;\r\n                    case 2:\r\n                        this._tank.y(this._tank.y() + this._moveV);\r\n                        break;\r\n                    case 3:\r\n                        this._tank.x(this._tank.x() - this._moveV);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                this.boundJudge();\r\n            // }\r\n        },\r\n        boundJudge: function () {\r\n            var cx = this._tank.x();\r\n            var cy = this._tank.y();\r\n\r\n            switch (this._curDirect) {\r\n                case 0:\r\n                    var ct = cy - this._tankH / 2;\r\n                    if (ct < 0) {\r\n                        this._tank.y(this._tankW / 2);\r\n                    } else {\r\n                        return;\r\n                    }\r\n                    break;\r\n                case 1:\r\n                    var cr = cx + this._tankH / 2;\r\n                    if (cr > this._sw) {\r\n                        this._tank.x(this._sw - this._tankW / 2);\r\n                    } else {\r\n                        return;\r\n                    }\r\n                case 2:\r\n                    var cb = cy + this._tankH / 2;\r\n                    if (cb > this._sh) {\r\n                        this._tank.y(this._sh - this._tankW / 2);\r\n                    } else {\r\n                        return;\r\n                    }\r\n                case 3:\r\n                    var cl = cx - this._tankH / 2;\r\n                    if (cl < 0) {\r\n                        this._tank.x(this._tankW / 2);\r\n                    } else {\r\n                        return;\r\n                    }\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n        directChange: function (direct) {\r\n            this._curDirect = direct;\r\n            var rotation = this._curDirect * 90;\r\n            this._tank.rotation(rotation);\r\n        },\r\n        fireBullet: function () {\r\n            var bullet = new window.Bullet(this._tstage, this._tlayer);\r\n            var pos = {};\r\n            switch (this._curDirect) {\r\n                case 0:\r\n                    pos.x = this._tank.x();\r\n                    pos.y = this._tank.y() - this._tankH / 2;\r\n                    break;\r\n                case 1:\r\n                    pos.x = this._tank.x() + this._tankH / 2;\r\n                    pos.y = this._tank.y();\r\n                    break;\r\n                case 2:\r\n                    pos.x = this._tank.x();\r\n                    pos.y = this._tank.y() + this._tankH / 2;\r\n                    break;\r\n                case 3:\r\n                    pos.x = this._tank.x() - this._tankH / 2;\r\n                    pos.y = this._tank.y();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            bullet.selectType(this._tankType);\r\n            bullet.createBullet(this._curDirect, pos);\r\n            this._bulletArr.push(bullet);\r\n        }\r\n    };\r\n\r\n\r\n\r\n    window.FoeTank = FoeTank;\r\n    window.MyTank = MyTank;\r\n\r\n})();"]}